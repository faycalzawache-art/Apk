
      - name: Verify APK Output
        run: |
          echo "ğŸ” Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙØ§Øª Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬..."
          
          APK_COUNT=$(find build/apk -name "*.apk" -type f 2>/dev/null | wc -l)
          
          if [ $APK_COUNT -gt 0 ]; then
            echo "âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ $APK_COUNT Ù…Ù„Ù APK"
            echo "ğŸ“„ Ù‚Ø§Ø¦Ù…Ø© Ù…Ù„ÙØ§Øª APK:"
            find build/apk -name "*.apk" -type f -exec ls -lh {} \;
            
            # Ø¹Ø±Ø¶ Ø­Ø¬Ù… Ø§Ù„Ù…Ù„ÙØ§Øª
            echo "ğŸ“Š Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ù…Ù„ÙØ§Øª:"
            for apk in build/apk/*.apk; do
              if [ -f "$apk" ]; then
                SIZE=$(stat -c%s "$apk")
                SIZE_MB=$(echo "scale=2; $SIZE / (1024*1024)" | bc)
                echo "   - $(basename $apk): ${SIZE_MB} MB"
              fi
            done
          else
            echo "âŒ Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠ Ù…Ù„ÙØ§Øª APK"
            echo "ğŸ“ Ù…Ø­ØªÙˆÙŠØ§Øª Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡:"
            ls -la build/apk/ 2>/dev/null || echo "Ø§Ù„Ù…Ø¬Ù„Ø¯ ÙØ§Ø±Øº"
            exit 1
          fi

      - name: Archive Build Artifacts
        if: success()
        uses: actions/upload-artifact@v4
        with:
          name: App-APK-v${{ github.run_number }}
          path: |
            build/apk/*.apk
            build/logs/
            requirements.backup.txt
          retention-days: 30
          if-no-files-found: error
          compression-level: 9

      - name: Create Build Report
        if: always()
        run: |
          echo "ğŸ“‹ Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¨Ù†Ø§Ø¡..."
          
          REPORT_FILE="build/build_report_${{ github.run_number }}.txt"
          
          cat > "$REPORT_FILE" << EOF
          ===================================
          ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø§Ø¡ APK
          ===================================
          Ø±Ù‚Ù… Ø§Ù„ØªØ´ØºÙŠÙ„: ${{ github.run_number }}
          Ø§Ù„ØªØ§Ø±ÙŠØ®: $(date)
          Ø§Ù„ÙØ±Ø¹: ${{ github.ref }}
          Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…: ${{ github.sha }}
          
          Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:
          ----------
          Ø¥ØµØ¯Ø§Ø± Python: ${{ env.PYTHON_VERSION }}
          Ø¥ØµØ¯Ø§Ø± Flutter: ${{ env.FLUTTER_VERSION }}
          Ù†ÙˆØ¹ Ø§Ù„Ø¨Ù†Ø§Ø¡: ${{ env.BUILD_TYPE }}
          Ø§Ù„Ù…Ø¤Ø³Ø³Ø©: ${{ env.ORG_NAME }}
          Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: ${{ env.PROJECT_NAME }}
          
          Ø§Ù„Ù†ØªØ§Ø¦Ø¬:
          --------
          Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡: ${{ job.status }}
          EOF
          
          # Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù„ÙØ§Øª
          echo "" >> "$REPORT_FILE"
          echo "Ù…Ù„ÙØ§Øª APK Ø§Ù„Ù…ÙˆÙ„Ø¯Ø©:" >> "$REPORT_FILE"
          find build/apk -name "*.apk" -exec basename {} \; 2>/dev/null >> "$REPORT_FILE" || echo "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ÙØ§Øª" >> "$REPORT_FILE"
          
          echo "ğŸ“¤ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±: $REPORT_FILE"

      - name: Upload Build Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: Build-Report-v${{ github.run_number }}
          path: build/build_report_*.txt
          retention-days: 7
          if-no-files-found: ignore
          - name: Cleanup Temporary Files
        if: always()
        run: |
          echo "ğŸ§¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©..."
          rm -rf ~/.gradle/caches/ 2>/dev/null || true
          rm -rf ~/.pub-cache/ 2>/dev/null || true
          echo "âœ… ØªÙ… Ø§Ù„ØªÙ†Ø¸ÙŠÙ"

      - name: Display Build Status
        if: always()
        run: |
          echo "ğŸ“¢ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ù†Ø§Ø¡: ${{ job.status }}"
          echo "ğŸ”— Ø±Ø§Ø¨Ø· Ø³Ø¬Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          echo "ğŸ•’ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: $(date)"
